# dependencies: libkeyutils-dev
# source: https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=b4a1b4f5047e4f54e194681125c74c0aa64d637d

all:
	gcc -o keyctl-race keyctl-race.c -lkeyutils -lpthread

clean:
	rm -f keyctl-race

check: all
	for i in `seq 1 10000`; do ./keyctl-race || break; done
	! dmesg | grep keyctl_read_key

